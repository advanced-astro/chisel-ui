---
import { Component } from '@chisel-ui/astro'

const { as = 'button', active = false, targetId, attr = 'active', ...props } = Astro.props
---

<Component {as} data-toggle={attr} data-target-id={targetId} {...props}>
    <slot />
</Component>

<script is:global>
    function onClick({ target }) {
        const toggleTarget = (target.dataset.targetId && document.getElementById(target.dataset.targetId)) || target
        const attr = target.dataset.toggle

        toggleTarget.hasAttribute(attr)
            ? toggleTarget.removeAttribute(attr)
            : toggleTarget.setAttribute(attr, '')
    }

    for (const elem of document.querySelectorAll('[data-toggle]')) {
        elem.addEventListener('click', onClick, true)
    }
</script>