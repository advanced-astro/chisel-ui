---
import { getBreakpointValue, uid } from '@chisel-ui/core'
import Layout from './Layout.astro'
import type { ColumnsProps } from './types.ts'

const {
	theme = {},
	id = uid(),
	columns = 1,
	dense = false,
	switchAt = '0px',
	...props
} = Astro.props as ColumnsProps

const safeColumns = columns ?? 1
const safeBreakpoint = getBreakpointValue(theme, switchAt)

const inlineStyle = `
    @media (min-width: ${safeBreakpoint}) {
        #${id} {
            --columns: ${safeColumns};
        }
    }
`
---

<Layout data-chisel-columns={dense ? 'dense' : ''} {id} {theme} {...props}>
	<slot />
</Layout>

<style set:html={inlineStyle}>

</style><style global>
	[data-chisel-columns] {
		box-sizing: border-box;
		display: grid;
		grid-template-columns: repeat(var(--columns, 1), 1fr);
		gap: var(--gap-block, 0px) var(--gap-inline, 0px);
		grid-auto-flow: row;
	}

	[data-chisel-columns='dense'] {
		grid-auto-flow: row dense;
	}
</style>
