---
import { joinStyles } from '@chisel-ui/core'
import './Frame.css'
import Component from './Component.astro'
import type { FrameProps } from './types.ts'

const FRACTION_PATTERN = /(?:[1-9][0-9]*|0).?\/.?[1-9][0-9]*/g

function getRatio(value?: typeof FrameProps['ratio']) {
	if (value.match(FRACTION_PATTERN)) {
		const [start, end] = value.split('/')
		return `${start.trim()}/${end.trim()}`
	} else if (Array.isArray(value)) {
		const [start, end] = value
		return `${start}/${end}`
	}

	return undefined
}

const { ratio, position, style = '', ...props } = Astro.props as FrameProps

const safeRatio = getRatio(ratio)

const componentStyle = joinStyles(
	safeRatio && `--ratio: ${safeRatio}`,
	position && `--position: ${position}`,
	style
)
---

<Component data-chisel-frame style={componentStyle} {...props}>
	<slot />
</Component>
